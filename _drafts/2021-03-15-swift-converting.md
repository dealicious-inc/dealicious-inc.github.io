---
layout: page
title: iOS 컨버팅의 추억
writer: 박경우
thumbnail: 'posts/2021-03-15-swift-converting-02.png'
---

## 발단

2018년 2월 1일 딜리셔스에 iOS 개발자로 이직 후 첫 출근을 했습니다.

맥북을 세팅하고 신상마켓 Xcode 프로젝트를 처음 열고 약 10분 뒤 가슴속에서 샤우팅과 함께 멘붕이 왔습니다. 프로젝트를 분석하고 알아갈수록 심리적 불안감은 점점 심해지고 심장박동이 빠르게 뛰기 시작했습니다.

**_아.. 나는 누구인가.. 여기는 어디인가.._**

</br>
## 전개

제가 생각했던 문제점들은 아래와 같았습니다.

1. **안드로이드ver에는 있고, 아이폰ver에는 없는 몇 기능이 있었습니다.**

    다수의 기능들이 안드로이드에는 있지만 아이폰에 없는 차별화 전략을 사용하고 있었습니다. (삼성 LG 화이팅!!) 만약 음식점에 갔는데 1층에는 있는 메뉴가 2층에서는 주문할 수 없다면? 매우 당황 스러울 것 같습니다.

1. **개발자 각자의 스타일로 작업이 되어 있었습니다.**

    처음엔 대표님이 iOS앱을 만들었고, 이후 iOS 개발자가 충원되면서 다른 코드스타일이 난무하는 문제가 발생했습니다.

1. **100% Objective-C 만 사용한 프로젝트였습니다.**

    그 때는 이미 Github에서 Swift가 지분이 높아져 있었고, 각종 오픈소스들도 더이상 ObjC 지원을 하지 않고 있었습니다. 지원하지 않는 오픈소스들은 우리가 직접 생명연장을 시키면서 힘들게 끌고 가고 있었습니다.

1. **소매앱과 도매앱이 별도의 프로젝트로 관리되고 있었습니다.**

    제일 힘들었던 문제였습니다. 예를 들어 특정 기능을 개발하는데 동일한 디자인, 리소스, API 등을 사용하지만 양쪽 프로젝트에 동일하게 추가하여 작업을 해야하는 수작업(a.k.a.노가다)이 필요했습니다. 유지보수도 동일한 수작업을 해야 했는데, 버그, 사이드이펙트가 양쪽 프로젝트에 모두 발생하니 수정도 두 번 해야 했습니다. 서비스에 이해도가 부족했던 저는 소매앱만 수정해서 문제가 되었던 적도 있었습니다. 나중에 입사하는 iOS 개발자가 있을 것이었기에 같은 문제가 반복될 수 밖에 없는 상황이었습니다.

![](/assets/image/posts/2021-03-15-swift-converting-01.png)
<신상마켓 Swift 컨버팅 전>

![](/assets/image/posts/2021-03-15-swift-converting-02.png)
<컨버팅 후>

위의 큰 문제덩어리들을 해결하기 위해서 Swift 컨버팅을 하고 싶었지만, 항시 진행되고 있는 프로젝트 업무들과 병행하기에는 무리가 있다고 판단했고, 안드로이드에만 있는 기능들을 하나씩 추가하는 작업부터 진행하였습니다. 이후 Swift 컨버팅의 꿈을 마음속 깊은 곳에 모셔만 두고 있다가 iOS 개발자가 충원되자 꿈을 펼칠 때라고 생각했습니다.

</br>
## 위기
그러나 개발자가 늘어나면서 프로젝트 업무도 늘어나는 건 당연했습니다. 더 이상 이렇게 개발을 하면 안 될 것같아 결단을 내려야 겠다고 생각했고, iOS 개발자들과 정말 쥐어짜고 또 쥐어짜서 일정을 산정해서 질렀습니다.

>1달 보름만 Swift 컨버팅에 집중하게 해주세요.
>운영이슈 이외의 모든 프로젝트에서 iOS는 홀딩시켜 주세요.

무모하고 거침없이 말했지만 너무나도 흔쾌하게 허락을 득하였고, 말이 통하는 개발자 대표님이 계시다는게 얼마나 큰 장점인지 몸소 체험했습니다. 오히려 부족하지 않겠냐는 대표님 걱정에 감동으로 눈물을 흘릴 뻔 하였으나 남자는 태어나서 3번만 우는 거라고 배웠습니다.

드디어 마음속 깊이 담아 두었던 Swift 컨버팅을 시작하였습니다. `개발기간 1달 보름, 개발인원 2명`. 쉽지 않은 도전이였지만 한편으로는 새로운 도전에 대한 설렘과 컨버팅이 완료되었을 때에 대한 기대가 교차했습니다.

프로젝트를 생성하고 총 3개의 타겟을 만들었습니다.

- 기본 타겟 : SinsangMarket
- 소매 타겟 : SinsangMarketSome
- 도매 타겟 : SinsangMarketDome

![](/assets/image/posts/2021-03-15-swift-converting-03.png)

- 기본 타겟에는 소매, 도매에서 공통적으로 재사용하는 UI Component, API, Model, Frameworks, Extension 등을 
- 소매, 도매 타겟은 각각의 앱에서만 사용하는 UI Component, API, Model, Frameworks 등을 추가하였습니다.
- 각각의 타겟에는 동일한 구조의 Group 을 만들고 각각의 Group 에 대한 규칙을 정해 프로젝트가 커질 수록 복잡해 질 수 있는 구조를 최소화 할 수 있게 하였습니다.

프로젝트와 빌드 세팅을 마무리하고 이제 개발을 시작할 수 있는 준비를 완료하였습니다.

(cocoapods, Git 관련 내용까지 쓰다보면 산으로 올라갔다 내려올 수 있어 생략하였습니다.)

UI개발에서는 기존에 사용하던 Storyboard를 사용하지 않기로 결정하였습니다. 
그 이유는 여러가지가 있었지만 아래 2가지 이유가 제일 컸습니다.
- Storyboard에서의 복잡한 UI구현 및 유지보수의 어려움
- 화면이 많아질 수록 Storyboard가 너무 느리다

Storyboard를 버렸으니 코드로 UI를 짜야 합니다. 프레임워크로 SnapKit과 Then을 실험적으로 사용해봤습니다. UI 인스턴스를 생성하고 Then의 클로저에 각종 속성을 세팅하였고, SnapKit으로 오토레이아웃을 코드로 작성했습니다. 장점은 Storyboard와 클래스를 왔다갔다 하며 작업하지 않아도 된다는 점이었고, 단점은 Storyboard처럼 시각화 되지 않아 빌드를 해야 결과를 볼 수 있다는 점이었습니다. 유지보수나 개발속도 측면에서  SnapKit과 Then 조합의 효율이 좋아 Swift 컨버팅에서 사용하기로 최종 결정하였습니다.
</br>
## 절정
개발을 시작할려고 하니 또 다른 문제들이 보이기 시작했습니다.

1. **문서들의 부재**

    복잡하고 모호한 조건이나 로직등을 확인할려고 하였으나 기획서의 소실과 문서화가 되어 있지 않아 코드로만 확인을 해야 했습니다. 레거시 코드등도 남아 있는 상황이라 Swift로 제2의 쓰레기장을 만들 수 있는 상황이라 난감했으나 다행히 안드로이드는 이전에 리펙토링을 하여 안드로이드 코드를 받아 참고하며 진행할 수 있었습니다.

1. **디자인 가이드**

    디자인 가이드가 없는 화면들이 많았습니다. 물론 그당시 작업할 떄는 있었겠지만 중간에 어떤 사유들로 소실된 것 같았습니다. 코드와 스토리보드로 레이아웃 작업을 하면서 너무 구시대 스타일이거나 안드로이드와 다른 디자인들은 디자인팀의 협조로 가이드를 받을 수 있었습니다.

1. **끝없는 상속**

    작업하며 제일 시간이 많이 소요되었던 것 같습니다. UIViewController, UIView 그리고 API 관련 Model 등이 재벌가의 유산 대물림과 같이 상속에 상속에 상속이 이루어 지는 경우와 하나의 Class 에서 상속받아 파생되는 Class 가 너무 많았습니다.

    ![](/assets/image/posts/2021-03-15-swift-converting-04.png)
    <상품 Model의 상속>
    
    신상마켓의 경우, 상품정보가 많아서 여러 상품 Model 이 존재하였습니다. 하나의 Goods Model 을 상속 받아 신상초이스, 상품상세정보, 주문상품정보 등의 별도 Model 이 존재하였고 상속받은 Model 로 부터 다시 상속받은 Model 들도 존재하였습니다. 상속을 받은 이유는 API에서 받는 필드명이 달라서, 특정 상황에만 사용하는 필드가 존해하여서 등 여러 이유가 있었습니다. 그림의 경우 Goods Model의 일부 상속만 표현했지만 더 많은 상속들이 이루어져 유지보수에 어려움이 있었습니다. 이후 Goods 하나의 Model로 통합하여 특정 상황에서만 사용하는 필드의 경우 주석 등으로 구분할 수 있게 수정하였습니다. 

이제 새로운 문제들이 파악됐으니 업부 분배를 할 차례입니다.

문서로 정리를 하고 진행하고 싶었으나 시간이 부족한 관계로 스프레드 시트에 우선 큰 기능별로 분류를 하였고 큰 기능들에 포함되어 있는 세부 기능들까지 고려하여 기능별 개발 기간을 산정하였습니다. 혹시나 개발을 진행하며 예상 일상을 초과한 경우 별도의 비고란의 두어 어떤 이유인지 작성해 두었습니다.

그리고 개발을 진행하며 예상치 못한 이슈나 까다로운 UI, 애니메이션의 경우 스프레드시트에 별도 정리하여 전체적인 개발이 완료된 이후 진행하기로 하였습니다. 위에서 정리한 스프레드시트를 기준으로 한명은 위에서부터 다른 한명은 아래에서 위로 작업하였으며 특정 기능에 종속되지 않고 접근 가능한 화면의 경우 기본 ViewControoler + Model(객체) 만 넘겨 언제든지 작업 할 수 있는 정도만 개발 후 스프레드시트에 추가하였습니다.

![](/assets/image/posts/2021-03-15-swift-converting-05.png)
<Swift 컨버팅 Gantt Chat>

![](/assets/image/posts/2021-03-15-swift-converting-06.png)
<세부 개발내역에 대한 진행률 파악을 위한 시트>

</br>
## 결말
어느덧 중간 단계에서 두개발자는 만날 수 있었고, 전체적인 큰 기능들이 개발이 완료되고 이전 앱과의 크로스체크로 누락된 기능 및 화면이 없는지 확인하고, 짧은 회고를 진행하여 이후 남은 개발에 좀 더 효율적인 방안등을 모색하였습니다. 이후 스프레드시트에 추가해 두었던 개발까지 완료하였습니다.

1달 보름 처음 산정한 일정에 딱 맞게 프로젝트를 완료하고, 전사에 배포하여 1~2주 정도는 QA를 진행하였습니다. 별도의 Branch 에서는 컨버팅 프로젝트가 진행되는 동안 안드로이드에 추가 된 기능등을 작업했습니다. QA가 끝난 후 드디어 앱스토어에 배포를 할 수 있었고, 약 두달간의 여정이 마무리 되었습니다. 

</br>
## 에필로그
일반적인 일정 산정시 4개월 이상 소요되는 프로젝트였으나 1달 보름안에 끝내야 하는 일정으로 야근과 주말, 휴일 없이 개발을 할 수 밖에 없었고, 딜리셔스를 다니면서 해야할 야근을 이 때 다 했습니다. 당시 유치원에 입학한 아이가 책상이 가지고 싶다 그랬는데 야근 수당으로 책상을 사줄 수 있는 멋진 아빠가 되었습니다.

처음에는 할 수 있을까 우려를 하며 시작한 프로젝트 였으나 왠지 모를 대학생 시절 팀프로젝트처럼 열정과 나름에 재미가 있었던 프로젝트 였습니다. 모두 끝나고 나서 두달간의 시간을 되돌아 보았을 때 프로젝트에 제일 중요한게 무엇인지 깨달을 수 있었습니다. 

`팀워크` & `커뮤니케이션`

머리속에 제일 크게 남은 두 가지 였습니다. 문서도 없고 여러 허들이 있었지만 함께 도전할 수 있었고 힘들 땐 의지할 수 있고 도움이 필요할 때 언제든지 편하게 요청할 수 있는 파트원과 여러 이슈상황에 서로에 의견을 자유롭게 이야기 하고 해결 방안을 함께 찾아 해결했던 커뮤니케이션이 있었기에 무탈하게 프로젝트를 완료할 수 있었습니다. 또한 직원들의 의견을 수렴하고 짧다면 짧고 길면 길 수 있는 약 2달간의 시간을 직원들을 믿고 맡겨주는 회사라 가능한 프로젝트였다고 생각합니다.

![](/assets/image/posts/2021-03-15-swift-converting-07.png)

현재는 컨버팅 이후 유지보수나 추가 개발시에도 유연하게 대처가 가능하며 본인이 작업하지 않았더라도 기존에 약속한 규칙등으로 누구나 빠른 분석과 대응이 가능합니다. 신규 개발자가 입사하여도 빠른 적응 및 프로젝트가 가능해졌다는 장점도 있습니다.

지금은 더 만족하고, 더욱 애정을 가지고 개발을 하고 있습니다.
